<div class="page-container">
  <div class="page-header">
    <h1 class="page-title">{{ origin === 'client' ? 'Commandes clients' : 'Commandes fournisseurs' }}</h1>
    <app-boutton-action (clickEvent)="nouvelleCommande()"></app-boutton-action>
  </div>

  <div class="alert alert-danger" *ngIf="errorMsg">
    {{errorMsg}}
  </div>

  <div class="data-table-container">
    <div class="table-wrapper">
      <table class="data-table">
        <thead>
          <tr>
            <th>Code</th>
            <th>Date</th>
            <th>{{ origin === 'client' ? 'Client' : 'Fournisseur' }}</th>
            <th>Nb Articles</th>
            <th>Total</th>
            <th>Statut</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let commande of commandes" class="table-row">
            <td>{{ commande.code }}</td>
            <td>{{ commande.dateCommande | date:'dd/MM/yyyy' }}</td>
            <td>{{ getClientFournisseurName(commande) }}</td>
            <td>{{ getNbArticles(commande) }}</td>
            <td>{{ getTotalCommande(commande) | currency:'EUR':'symbol':'1.2-2' }}</td>
            <td>
              <span class="badge badge-success">Validée</span>
            </td>
            <td class="actions-cell">
              <button class="btn-action btn-edit" (click)="modifierCommande(commande)">
                <i class="fas fa-edit"></i>
              </button>
              <button class="btn-action btn-delete" (click)="supprimerCommande(commande)">
                <i class="fas fa-trash"></i>
              </button>
              <button class="btn-action btn-view" (click)="voirDetails(commande)">
                <i class="fas fa-eye"></i>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    
    <div *ngIf="commandes.length === 0" class="text-center">
      <p>Aucune commande trouvée</p>
    </div>
    
    <div class="table-footer" *ngIf="commandes.length > 0">
      <div class="row">
        <div class="col-md-6 text-start">
          <h5>{{ commandes.length }} Commande(s)</h5>
        </div>
        <div class="col-md-6 text-end">
          <h5>Total: {{ getTotalGeneral() | currency:'EUR':'symbol':'1.2-2' }}</h5>
        </div>
      </div>
    </div>
    <app-pagination></app-pagination>
  </div>
</div>

<app-modal-confirmation 
  [isVisible]="showDeleteModal"
  [message]="getDeleteMessage()"
  (confirmed)="confirmerSuppression()"
  (cancelled)="fermerModal()">
</app-modal-confirmation>
